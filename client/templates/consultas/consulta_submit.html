<template name="consultaSubmit">
  <form name="consulta" class="consulta-form form">
    {{> buttonsSave}}
    <hr>
    <div class="form-group {{errorClass 'motivo'}}">
      <div class="controls">
        <label for="motivo">Motivo de la consulta</label>
        <textarea name="motivo" id="motivo" class="form-control" rows="3" required="true"></textarea>
        <span class="help-block">{{errorMessage 'motivo'}}</span>
      </div>
    </div>
    <div class="form-group {{errorClass 'diagnostico'}}">
      <div class="controls">
        <div class="panel panel-info" style="height:200px;">
          <div class="panel-heading clearfix">
            <div class="row">
              <div class="{{isSearchCIE10 0}} col-xs-6 col-md-6 col-lg-6">
                <label class="control-label" for="diagnostico">Diagnóstico</label>
              </div>
              <div class="{{isSearchCIE10 0}} col-xs-6 col-md-6 col-lg-6">
                <button type="button" name="btnCie10" id="btnCie10" class="btn btn-info btn-xs pull-right">
                  <img src="/img/ic_search_white_18px.svg" />CIE10</button>
              </div>
              <div class="{{isSearchCIE10 1}} col-xs-6 col-md-6 col-lg-6">
                <button type="button" name="btnBack" id="btnBack" class="btn btn-info btn-xs" title="Volver">
                  <img src="/img/ic_arrow_back_white_18px.svg" />
                </button>
                <button type="button" name="btnDone" id="btnDone" class="btn btn-info btn-xs" title="Guardar">
                  <img src="/img/ic_done_white_18px.svg" />
                </button>
                <button type="button" name="btnClear" id="btnClear" class="btn btn-info btn-xs" title="Limpiar">
                  <img src="/img/ic_clear_white_18px.svg" />
                </button>
              </div>
              <div class="input-group col-xs-6 col-md-6 col-lg-6 {{isSearchCIE10 1}}">
                <input type="text" class="form-control" id="search-cie10" placeholder="buscar&hellip;" style="border-color: white">
                <span class="input-group-addon btn-primary" style="color: white;border-color: white"><i class="glyphicon glyphicon-search"></i></span>
              </div>
            </div>
          </div>
          <div class="panel-body" style="padding: 0px 0px 0px 15px;">
            <textarea name="diagnostico" id="diagnostico" class="form-control {{isSearchCIE10 0}}" rows="6" style="margin-top: 10px;margin-left: -8px;" required="true"></textarea>
            <span class="help-block">{{errorMessage 'diagnostico'}}</span>
            <div class="row {{isSearchCIE10 1}}">
              <div style="overflow:auto; height:105px">
                {{#each cie10}}
                <div class="col-xs-10 col-md-10 col-lg-10">
                  <div class="controls">
                    <label title="{{dec10}}" class="crop-text-label" style="display: inline-block; width: 43px;">{{{id10}}}</label>
                    <label title="{{dec10}}" class="crop-text-label">{{{dec10}}}</label>
                  </div>
                </div>
                <div class="col-xs-2 col-md-2 col-lg-2">
                  <input id="chk-cie10" name="chk-cie10" type="checkbox" />
                </div>
                {{/each}}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="form-group {{errorClass 'tratamiento'}}">
      <div class="controls">
        <label for="tratamientos">Tratamiento</label>
        <textarea name="tratamiento" id="tratamiento" class="form-control" rows="3" required="true"></textarea>
        <span class="help-block">{{errorMessage 'tratamiento'}}</span>
      </div>
    </div>

    <div class="panel panel-info">
      <div class="panel-heading clearfix">
        <h3 class="panel-title pull-left">Receta</h3>
        <div class="btn-group pull-right">
          <a id="btnAdd" class="btn btn-info btn-xs">
            <img src="/img/ic_add_white_18px.svg" />
          </a>
        </div>
      </div>
      <div class="panel-body">
        <!-- <div style="overflow-y: auto; overflow-x: hidden; height:220px;"> -->
        <div class="row">
          <div class="form-group">
            {{#each recetas}}
            <div class="col-xs-12 col-md-12 col-lg-6">
              <div class="form-group {{errorClass 'medicamento' @index}}">
                <label class="control-label">Medicamento</label>
                <div class="input-group">
                  <input type="text" id="medicamento{{@index}}" name="medicamento{{@index}}" class="form-control" value="{{medicamento}}" required="true" />
                  <span class="input-group-addon">
                    <label><input id="unicaDosis{{@index}}" name="unicaDosis{{@index}}" type="checkbox" checked="{{unicaDosis}}" aria-label="..."> Única vez</label>
                  </span>
                </div>
              </div>
            </div>
            <div class="col-xs-6 col-md-6 col-lg-2">
              <div class="form-group {{errorClass 'dosis' @index}}">
                <label class="control-label">Dosis</label>
                <div class="input-group">
                  <input type="number" id="dosis{{@index}}" name="dosis{{@index}}" placeholder="" class="form-control" value="{{dosis}}" required="true" />
                  <span class="input-group-addon">
                    <select class="" id="dosisTipo{{@index}}" name="dosisTipo{{@index}}" style="border: none; background-color: transparent;">
                      {{#each tiposDosis}}
                          <option value="{{_id}}" > {{descripcion}} </option>
                      {{/each}}
                      <option value="otros" >Otros</option>
                    </select>
                  </span>
                </div>
              </div>
            </div>
            <div class="col-xs-6 col-md-6 col-lg-2">
              <div class="form-group {{errorClass 'frecuencia' @index}}">
                <label class="control-label">Frecuencia</label>
                <div class="input-group">
                  <input type="number" id="frecuencia{{@index}}" name="frecuencia{{@index}}" placeholder="" class="form-control" required="true" disabled="{{isOnlyOneDosis}}" />
                  <span class="input-group-addon">
                    <select class="" id="frecuenciaTipo{{@index}}" name="frecuenciaTipo{{@index}}" style="border: none; background-color: transparent;" disabled="{{isOnlyOneDosis}}">
                      {{#each tiposFrecuencia}}
                          <option value="{{_id}}" > {{descripcion}} </option>
                      {{/each}}
                      <option value="otros" >Otros</option>
                    </select>
                  </span>
                </div>
              </div>
            </div>
            <div class="col-xs-6 col-md-6 col-lg-2">
              <div class="form-group {{errorClass 'duracion' @index}}">
                <label class="control-label">Duración</label>
                <div class="input-group">
                  <input type="number" id="duracion{{@index}}" name="duracion{{@index}}" placeholder="" class="form-control" required="true" disabled="{{isOnlyOneDosis}}" />
                  <span class="input-group-addon">
                    <select class="" id="duracionTipo{{@index}}" name="duracionTipo{{@index}}" style="border: none; background-color: transparent;"  disabled="{{isOnlyOneDosis}}">
                      {{#each tiposDuracion}}
                          <option value="{{_id}}" > {{descripcion}} </option>
                      {{/each}}
                      <option value="otros" >Otros</option>
                    </select>
                  </span>
                </div>
              </div>
            </div>
            <div class="form-group  {{errorClass 'recetas'}}">
              <div class="controls">
                <span class="help-block">{{errorMessage 'recetas' @index}}</span>
              </div>
            </div>
            {{/each}}
          </div>
        </div>
        <!-- </div> -->
      </div>
    </div>
    <div hidden="{{isEditing}}">
      <button type="submit" class="btn btn-primary">Guardar Consulta</button>
    </div>

    <div id="myModal" class="modal fade" role="dialog">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h4 class="modal-title">Agregue un nuevo valor</h4>
          </div>
          <div class="modal-body">
            <input type="text" id="otherText" name="otherText" class="form-control" />
          </div>
          <div class="modal-footer">
            <button type="button" id="btnAddNewTipo" class="btn btn-default" data-dismiss="modal">Guardar</button>
          </div>
        </div>
      </div>
    </div>

  </form>
</template>
